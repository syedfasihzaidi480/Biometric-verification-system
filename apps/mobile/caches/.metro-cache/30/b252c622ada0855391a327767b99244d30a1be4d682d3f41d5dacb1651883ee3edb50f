{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":54},"end":{"line":2,"column":40,"index":94}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":96},"end":{"line":3,"column":43,"index":139}}],"key":"dzXjryHTvdSCDFGj8HDj8YCDHm4=","exportNames":["*"],"imports":1}},{"name":"@/utils/auth/store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":141},"end":{"line":4,"column":50,"index":191}}],"key":"VzDMA11jGiXP9AFTRgw0CVGaxUs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.syncNotificationPreference = syncNotificationPreference;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _expoNotifications = require(_dependencyMap[1], \"expo-notifications\");\n  var Notifications = _interopNamespace(_expoNotifications);\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _utilsApi = require(_dependencyMap[3], \"@/utils/api\");\n  var _utilsAuthStore = require(_dependencyMap[4], \"@/utils/auth/store\");\n  // Best-effort sync; safe to call without awaiting in UI\n  function syncNotificationPreference(_x) {\n    return _syncNotificationPreference.apply(this, arguments);\n  }\n  function _syncNotificationPreference() {\n    _syncNotificationPreference = (0, _asyncToGenerator.default)(function* (enabled) {\n      try {\n        var token = null;\n        if (enabled) {\n          try {\n            // On SDK 53+, projectId is auto-resolved when using EAS Updates. Fallback without.\n            var res = yield Notifications.getExpoPushTokenAsync();\n            token = res?.data || null;\n          } catch (e) {\n            // No token available (e.g., missing config); still sync enabled flag\n            token = null;\n          }\n        }\n        var auth = _utilsAuthStore.useAuthStore.getState().auth;\n        var userId = auth?.user?.id || auth?.user?.auth_user_id || null;\n        yield (0, _utilsApi.apiFetchJson)('/api/notifications/preferences', {\n          method: 'POST',\n          body: {\n            enabled: !!enabled,\n            token,\n            platform: _reactNative.Platform.OS,\n            userId\n          }\n        });\n      } catch (e) {\n        // Non-fatal; log and continue\n        console.warn('[syncNotificationPreference] Failed', e?.message);\n      }\n    });\n    return _syncNotificationPreference.apply(this, arguments);\n  }\n});","lineCount":71,"map":[[27,2,7,0,"exports"],[27,9,7,0],[27,10,7,0,"syncNotificationPreference"],[27,36,7,0],[27,39,7,0,"syncNotificationPreference"],[27,65,7,0],[28,2,37,1],[28,6,37,1,"_babelRuntimeHelpersAsyncToGenerator"],[28,42,37,1],[28,45,37,1,"require"],[28,52,37,1],[28,53,37,1,"_dependencyMap"],[28,67,37,1],[29,2,37,1],[29,6,37,1,"_asyncToGenerator"],[29,23,37,1],[29,26,37,1,"_interopDefault"],[29,41,37,1],[29,42,37,1,"_babelRuntimeHelpersAsyncToGenerator"],[29,78,37,1],[30,2,1,0],[30,6,1,0,"_expoNotifications"],[30,24,1,0],[30,27,1,0,"require"],[30,34,1,0],[30,35,1,0,"_dependencyMap"],[30,49,1,0],[31,2,1,0],[31,6,1,0,"Notifications"],[31,19,1,0],[31,22,1,0,"_interopNamespace"],[31,39,1,0],[31,40,1,0,"_expoNotifications"],[31,58,1,0],[32,2,2,0],[32,6,2,0,"_reactNative"],[32,18,2,0],[32,21,2,0,"require"],[32,28,2,0],[32,29,2,0,"_dependencyMap"],[32,43,2,0],[33,2,3,0],[33,6,3,0,"_utilsApi"],[33,15,3,0],[33,18,3,0,"require"],[33,25,3,0],[33,26,3,0,"_dependencyMap"],[33,40,3,0],[34,2,4,0],[34,6,4,0,"_utilsAuthStore"],[34,21,4,0],[34,24,4,0,"require"],[34,31,4,0],[34,32,4,0,"_dependencyMap"],[34,46,4,0],[35,2,6,0],[36,2,6,0],[36,11,7,22,"syncNotificationPreference"],[36,37,7,48,"syncNotificationPreference"],[36,38,7,48,"_x"],[36,40,7,48],[37,4,7,48],[37,11,7,48,"_syncNotificationPreference"],[37,38,7,48],[37,39,7,48,"apply"],[37,44,7,48],[37,51,7,48,"arguments"],[37,60,7,48],[38,2,7,48],[39,2,7,48],[39,11,7,48,"_syncNotificationPreference"],[39,39,7,48],[40,4,7,48,"_syncNotificationPreference"],[40,31,7,48],[40,38,7,48,"_asyncToGenerator"],[40,55,7,48],[40,56,7,48,"default"],[40,63,7,48],[40,65,7,7],[40,76,7,49,"enabled"],[40,83,7,56],[40,85,7,58],[41,6,8,2],[41,10,8,6],[42,8,9,4],[42,12,9,8,"token"],[42,17,9,13],[42,20,9,16],[42,24,9,20],[43,8,10,4],[43,12,10,8,"enabled"],[43,19,10,15],[43,21,10,17],[44,10,11,6],[44,14,11,10],[45,12,12,8],[46,12,13,8],[46,16,13,14,"res"],[46,19,13,17],[46,28,13,26,"Notifications"],[46,41,13,39],[46,42,13,40,"getExpoPushTokenAsync"],[46,63,13,61],[46,64,13,62],[46,65,13,63],[47,12,14,8,"token"],[47,17,14,13],[47,20,14,16,"res"],[47,23,14,19],[47,25,14,21,"data"],[47,29,14,25],[47,33,14,29],[47,37,14,33],[48,10,15,6],[48,11,15,7],[48,12,15,8],[48,19,15,15,"e"],[48,20,15,16],[48,22,15,18],[49,12,16,8],[50,12,17,8,"token"],[50,17,17,13],[50,20,17,16],[50,24,17,20],[51,10,18,6],[52,8,19,4],[53,8,21,4],[53,12,21,10,"auth"],[53,16,21,14],[53,19,21,17,"useAuthStore"],[53,34,21,29],[53,35,21,29,"useAuthStore"],[53,47,21,29],[53,48,21,30,"getState"],[53,56,21,38],[53,57,21,39],[53,58,21,40],[53,59,21,41,"auth"],[53,63,21,45],[54,8,22,4],[54,12,22,10,"userId"],[54,18,22,16],[54,21,22,19,"auth"],[54,25,22,23],[54,27,22,25,"user"],[54,31,22,29],[54,33,22,31,"id"],[54,35,22,33],[54,39,22,37,"auth"],[54,43,22,41],[54,45,22,43,"user"],[54,49,22,47],[54,51,22,49,"auth_user_id"],[54,63,22,61],[54,67,22,65],[54,71,22,69],[55,8,24,4],[55,14,24,10],[55,18,24,10,"apiFetchJson"],[55,27,24,22],[55,28,24,22,"apiFetchJson"],[55,40,24,22],[55,42,24,23],[55,74,24,55],[55,76,24,57],[56,10,25,6,"method"],[56,16,25,12],[56,18,25,14],[56,24,25,20],[57,10,26,6,"body"],[57,14,26,10],[57,16,26,12],[58,12,27,8,"enabled"],[58,19,27,15],[58,21,27,17],[58,22,27,18],[58,23,27,19,"enabled"],[58,30,27,26],[59,12,28,8,"token"],[59,17,28,13],[60,12,29,8,"platform"],[60,20,29,16],[60,22,29,18,"Platform"],[60,34,29,26],[60,35,29,26,"Platform"],[60,43,29,26],[60,44,29,27,"OS"],[60,46,29,29],[61,12,30,8,"userId"],[62,10,31,6],[63,8,32,4],[63,9,32,5],[63,10,32,6],[64,6,33,2],[64,7,33,3],[64,8,33,4],[64,15,33,11,"e"],[64,16,33,12],[64,18,33,14],[65,8,34,4],[66,8,35,4,"console"],[66,15,35,11],[66,16,35,12,"warn"],[66,20,35,16],[66,21,35,17],[66,58,35,54],[66,60,35,56,"e"],[66,61,35,57],[66,63,35,59,"message"],[66,70,35,66],[66,71,35,67],[67,6,36,2],[68,4,37,0],[68,5,37,1],[69,4,37,1],[69,11,37,1,"_syncNotificationPreference"],[69,38,37,1],[69,39,37,1,"apply"],[69,44,37,1],[69,51,37,1,"arguments"],[69,60,37,1],[70,2,37,1],[71,0,37,1],[71,3]],"functionMap":{"names":["<global>","syncNotificationPreference"],"mappings":"AAA;OCM;CD8B"},"hasCjsExports":false},"type":"js/module"}]}